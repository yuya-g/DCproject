# DCproject

## 背景
現在の電力配分は、経験に基づく推定に頼っているため、過剰供給が発生し、電力や設備資源の無駄が生じています。一方で、オイル温度は変圧器の状態を反映する重要な指標であり、その予測を通じて以下の効果が期待されます：
- **最適な負荷配分の実現**
- **余分な電力供給の削減**
- **設備資源の効率的利用**

本プロジェクトでは、オイル温度の時系列データを活用し、予測モデルを構築することでこれらの課題に対応します。

---
## 前提
### Prophetを選んだ理由

### **(a) 周期性のモデリング手法**
- 上記の**フーリエ変換**による周期性分析を内部的に利用し、ユーザーが特別な知識を持たなくてもデータの周期性をモデル化できる。
- 周期性の自動分解においてSTL分解や他の分解手法と同等以上の効果を発揮。

### **(b) トレンドのモデリング手法**
- Prophetは上記の「移動平均」や「多項式回帰」によるトレンド分析を超えて、変化点に対応可能なトレンドモデリングを採用。
- **線形トレンド**と**ロジスティック成長**モデルを柔軟に切り替えられる点で、長期的・非線形的なトレンド変化への対応力が高い。

### **(c) 異常値や残差の処理**
- 上記の枠組みでは異常値の影響を受けやすい「移動平均」や「加法モデル」と比較し、Prophetは異常値に対してロバストな推定を行う仕組みを持つ。

### **(d) モデルの解釈性**
- STL分解と同様に、Prophetはトレンド・周期性・残差を独立した成分として分離するため、結果の解釈性が高い。
- また、予測結果に対する不確実性の範囲（予測区間）を提供することで、統計的な信頼性を担保。

### **(e) 残差部分のランダムフォレスト検証**
- Prophetのトレンド・周期性を除いた残差をランダムフォレストで予測したが、MAEやRMSEの精度が下がった。

---
## データの前処理
データにはProphetを用いて異常値検出と線形補間を行い、信頼性の高い入力データを生成しました。
:yuya-g-pretreatment

---
## プレ分析

### 前提モデル
単純な重回帰モデルを基盤として、多重共線性を除去したモデル構築を進めました。
説明変数の実測値を使って目的変数（OT）をどのくらい説明でき、多重共線性がないかを確認しました。
:yuya-g-preanalytics
結論は以下のモデルが最適であった。
  Feature       VIF       寄与率
0    HUFL  1.060204  0.868268
1    LUFL  1.139002  0.096100
2    HULL  1.144633  0.028035
3    LULL  1.186592  0.007597
MAE: 5.445341105260387
RMSE: 6.981646859644499
R^2: 0.28609282387968904

---

## 検証結果

### 検証0: 単純なオイル温度のProphetモデル
- **MAE**: 9.2080  
- **RMSE**: 11.2260  

### 検証1: Prophetを用いた説明変数の時系列予測 + 重回帰モデル
説明変数を時系列モデルとして予測し、それらを重回帰に組み込んだモデル。
- **MAE**: 6.5489  
- **RMSE**: 7.7795  

### 検証2: Prophetによる目的変数の特徴量抽出 + 他の説明変数との組み合わせ
目的変数の時系列特性（季節性・トレンド）を特徴量として取り出し、重回帰モデルを構築。
- **MAE**: 8.3586  
- **RMSE**: 10.1403  

### 検証3: Prophetによる目的変数の残差分析 + 重回帰モデル
目的変数から季節性・トレンドを差し引き、残差に対して重回帰を適用し、予測に季節性・トレンドを再付加。
- **Residual MAE**: 6.7543  
- **Residual RMSE**: 8.0062  

---

## 使用技術
- **Prophet**：時系列データの異常値検出・補正および季節性とトレンドの解析。
- **重回帰分析**：説明変数間の多重共線性を考慮したモデル設計。
- **評価指標**：MAE, RMSE, R²を用いてモデルの性能を総合評価。

---

## 今後の課題
1. **さらなるモデル改善**  
   - 他のアルゴリズム（例：LSTMやXGBoost）の導入。
   - 非線形特性を考慮したモデルの構築。
2. **システムへの応用**  
   - 本予測モデルを電力配分システムに統合し、負荷配分の最適化を図る。

---

## インストールと実行方法

1. 必要なライブラリをインストール：
   ```bash
   pip install pandas prophet scikit-learn
   ```

2. スクリプトを実行してデータを処理・学習：
   ```bash
   python oil_temperature_forecast.py
   ```

3. 結果を確認：
   - 各モデルのMAE, RMSEが表示されます。
   - 予測結果の可視化プロットが出力されます。

---

## 連絡先
本プロジェクトに関する質問やフィードバックは以下にお願いします：
- Email: example@example.com
- GitHub: [GitHubリンク](https://github.com/example)

--- 

